package com.inventory.myserviceimpl;

import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.inventory.mydto.ReturnToVendorCombinedDto;
import com.inventory.mydto.TSFCombinedDto;
import com.inventory.myentity.RTVInfo;
import com.inventory.myentity.RTVProducts;
import com.inventory.myentity.TsfReasonCodes;
import com.inventory.myrepository.ProductDetailsRepo;
import com.inventory.myrepository.ProductRepo;
import com.inventory.myrepository.StoreRepo;
import com.inventory.myrepository.TsfDetailsRepo;
import com.inventory.myrepository.TsfHeadRepo;
import com.inventory.myrepository.TsfReasonCodesRepo;
import com.inventory.myservice.TransferReceiveService;

@Service
public class TransferReceiveServiceImpl implements TransferReceiveService {

	@Autowired
	private TsfHeadRepo tsfHeadRepo;

	@Autowired
	private StoreRepo storeRepo;

	@Autowired
	private TsfDetailsRepo tsfDetailsRepo;

	@Autowired
	private TsfReasonCodesRepo tsfReasonCodesRepo;

	@Autowired
	private ProductRepo productRepo;

	@Autowired
	private ProductDetailsRepo productDetailsRepo;

	// function to get All TSF Reason Codes
	@Override
	public List<TsfReasonCodes> getTsfReasonCodes() {
		List<TsfReasonCodes> tsfReasonCodes = tsfReasonCodesRepo.findAll();
		return tsfReasonCodes;
	}
	
	// Function to create Transfer
		@Override
		public String createTansfer(TSFCombinedDto tsfCombinedDto, String store) {

			RTVInfo RTVInfo = new RTVInfo(Id, RTVCombinedDto.getRtvInfodto().getSupplierId(),
					RTVCombinedDto.getRtvInfodto().getStoreId(), RTVCombinedDto.getRtvInfodto().getTotalSku(),
					RTVCombinedDto.getRtvInfodto().getCreatedDate(), RTVCombinedDto.getRtvInfodto().getCreatedBy(),
					RTVCombinedDto.getRtvInfodto().getStatus(), RTVCombinedDto.getRtvInfodto().getDefaultReasonCode(),
					RTVCombinedDto.getRtvInfodto().getDispatchedUser(), RTVCombinedDto.getRtvInfodto().getDispatchedDate());

			RTVInfo = rtvInfoRepo.save(RTVInfo);

			List<RTVProducts> rtvProducts = new ArrayList<>();
			for (int i = 0; i < RTVCombinedDto.getRtvProductsdto().size(); i++) {
				rtvProducts.add(new RTVProducts(RTVCombinedDto.getRtvProductsdto().get(i).getAttachedImage(),
						RTVCombinedDto.getRtvProductsdto().get(i).getItemNumber(),
						RTVCombinedDto.getRtvProductsdto().get(i).getItemName(),
						RTVCombinedDto.getRtvProductsdto().get(i).getCategory(),
						RTVCombinedDto.getRtvProductsdto().get(i).getColor(),
						RTVCombinedDto.getRtvProductsdto().get(i).getCost(),
						RTVCombinedDto.getRtvProductsdto().get(i).getPrice(),
						RTVCombinedDto.getRtvProductsdto().get(i).getSize(),
						RTVCombinedDto.getRtvProductsdto().get(i).getStore(),
						RTVCombinedDto.getRtvProductsdto().get(i).getReturnQty(),
						RTVCombinedDto.getRtvProductsdto().get(i).getReturnReason(),
						RTVCombinedDto.getRtvProductsdto().get(i).getImageData(),
						RTVCombinedDto.getRtvProductsdto().get(i).getUpc(),
						RTVCombinedDto.getRtvProductsdto().get(i).getSku(),
						RTVCombinedDto.getRtvProductsdto().get(i).getTaxPercentage(),
						RTVCombinedDto.getRtvProductsdto().get(i).getTaxCode(), RTVInfo));
			}

			rtvProductsRepo.saveAll(rtvProducts);
			return "Products saved successfully";
		}

}
